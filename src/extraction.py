# Prathit Kurup, Victoria Figueroa
# 02/03/2026
# This script extracts the LobbyView data for Fortune 500 companies in the 116th Congress

import pandas as pd
import re

# TODO: double check that all variations accounted for (bc only 86 unqiue clients appear)
# Mapping of Fortune 500 companies to their known name variations in LobbyView data
fortune_500_names = {
    "WALMART":["WAL-MART STORES INC"],
    "EXXONMOBIL":["EXXON MOBIL CORPORATION"],
    "APPLE":["APPLE INC."],
    "BERKSHIRE HATHAWAY":["BERKSHIRE HATHAWAY ENERGY"],
    "AMAZON":["AMAZON.COM (FRA PILLPACK AN AMAZON COMPANY)","AMAZON.COM SERVICES LLC","AMAZON WEB SERVICES"],
    "UNITED HEALTH GROUP":["UNITEDHEALTH GROUP"],
    "MCKESSON":["MCKESSON CORPORATION"],
    "CVS HEALTH":["CVS HEALTH"],
    "AT&T":["AT&T"],
    "AMERISOURCEBERGEN":["AMERISOURCEBERGEN CORPORATION"],
    "FORD":["FORD MOTOR COMPANY"],
    "GENERAL MOTORS":["GENERAL MOTORS COMPANY"],
    "COSTCO":["COSTCO WHOLESALE CORPORATION"],
    "ALPHABET":["GOOGLE, INC.", "GOOGLE, INC. ON BEHALF OF X"],
    "CARDINAL HEALTH":["CARDINAL HEALTH"],
    "WALGREENS BOOTS ALLIANCE":["WALGREEN CO."],
    "JPMORGAN CHASE & CO.":["JPMORGAN CHASE HOLDINGS LLC", "JP MORGAN CHASE HOLDINGS"],
    "VERIZON":["VERIZON COMMUNICATIONS"],
    "KROGER":["THE KROGER CO."],
    "GENERAL ELECTRIC":["GENERAL ELECTRIC COMPANY"],
    "CHEVRON":["CHEVRON"],
    "FANNIE MAE":["FANNIE MAE"],
    "PHILLIPS 66":["PHILLIPS 66"],
    "VALERO ENERGY":["VALERO ENERGY"],
    "BANK OF AMERICA":["BANK OF AMERICA"],
    "MICROSOFT":["MICROSOFT"],
    "HOME DEPOT":["HOME DEPOT"],
    "BOEING":["BOEING"],
    "WELLS FARGO":["WELLS FARGO"],
    "CITIGROUP":["CITIGROUP"],
    "MARATHON PETROLEUM":["MARATHON PETROLEUM"],
    "COMCAST":["COMCAST"],
    "ANTHEM":["ANTHEM"],
    "DELL TECHNOLOGIES":["DELL TECHNOLOGIES"],
    "DUPONT DE NEMOURS":["DUPONT DE NEMOURS"],
    "STATE FARM INSURANCE":["STATE FARM INSURANCE"],
    "JOHNSON & JOHNSON":["JOHNSON & JOHNSON"],
    "IBM":["IBM"],
    "TARGET":["TARGET"],
    "FREDDIE MAC":["FREDDIE MAC"],
    "UNITED PARCEL SERVICE":["UNITED PARCEL SERVICE"],
    "LOWE'S":["LOWE'S"],
    "INTEL":["INTEL"],
    "METLIFE":["METLIFE"],
    "PROCTER & GAMBLE":["PROCTER & GAMBLE"],
    "UNITED TECHNOLOGIES":["UNITED TECHNOLOGIES"],
    "FEDEX":["FEDEX"],
    "PEPSICO":["PEPSICO"],
    "ARCHER DANIELS MIDLAND":["ARCHER DANIELS MIDLAND"],
    "PRUDENTIAL FINANCIAL":["PRUDENTIAL FINANCIAL"],
    "CENTENE":["CENTENE"],
    "ALBERTSONS":["ALBERTSONS"],
    "WALT DISNEY":["WALT DISNEY"],
    "SYSCO":["SYSCO"],
    "HP":["HP"],
    "HUMANA":["HUMANA"],
    "FACEBOOK":["FACEBOOK"],
    "CATERPILLAR":["CATERPILLAR"],
    "ENERGY TRANSFER":["ENERGY TRANSFER"],
    "LOCKHEED MARTIN":["LOCKHEED MARTIN"],
    "PFIZER":["PFIZER"],
    "GOLDMAN SACHS GROUP":["GOLDMAN SACHS GROUP"],
    "MORGAN STANLEY":["MORGAN STANLEY"],
    "CISCO SYSTEMS":["CISCO SYSTEMS"],
    "CIGNA":["CIGNA"],
    "AIG":["AIG"],
    "HCA HEALTHCARE":["HCA HEALTHCARE"],
    "AMERICAN AIRLINES GROUP":["AMERICAN AIRLINES GROUP"],
    "DELTA AIR LINES":["DELTA AIR LINES"],
    "CHARTER COMMUNICATIONS":["CHARTER COMMUNICATIONS"],
    "NEW YORK LIFE INSURANCE":["NEW YORK LIFE INSURANCE"],
    "AMERICAN EXPRESS":["AMERICAN EXPRESS"],
    "NATIONWIDE":["NATIONWIDE"],
    "BEST BUY":["BEST BUY"],
    "LIBERTY MUTUAL INSURANCE GROUP":["LIBERTY MUTUAL INSURANCE GROUP"],
    "MERCK":["MERCK"],
    "HONEYWELL INTERNATIONAL":["HONEYWELL INTERNATIONAL"],
    "UNITED CONTINENTAL HOLDINGS":["UNITED CONTINENTAL HOLDINGS"],
    "TIAA":["TIAA"],
    "TYSON FOODS":["TYSON FOODS"],
    "ORACLE":["ORACLE"],
    "ALLSTATE":["ALLSTATE"],
    "WORLD FUEL SERVICES":["WORLD FUEL SERVICES"],
    "MASSACHUSETTS MUTUAL LIFE INSURANCE":["MASSACHUSETTS MUTUAL LIFE INSURANCE"],
    "TJX":["TJX"],
    "CONOCOPHILLIPS":["CONOCOPHILLIPS"],
    "DEERE":["DEERE"],
    "TECH DATA":["TECH DATA"],
    "ENTERPRISE PRODUCTS PARTNERS":["ENTERPRISE PRODUCTS PARTNERS"],
    "NIKE":["NIKE"],
    "PUBLIX SUPER MARKETS":["PUBLIX SUPER MARKETS"],
    "GENERAL DYNAMICS":["GENERAL DYNAMICS"],
    "EXELON":["EXELON"],
    "PLAINS GP HOLDINGS":["PLAINS GP HOLDINGS"],
    "3M":["3M"],
    "ABBVIE":["ABBVIE"],
    "CHS":["CHS"],
    "CAPITAL ONE FINANCIAL":["CAPITAL ONE FINANCIAL"],
    "PROGRESSIVE":["PROGRESSIVE"],
    "COCA-COLA":["COCA-COLA"],
    "USAA":["USAA"],
    "HEWLETT PACKARD ENTERPRISE":["HEWLETT PACKARD ENTERPRISE"],
    "ABBOTT LABORATORIES":["ABBOTT LABORATORIES"],
    "TWENTY-FIRST CENTURY FOX":["TWENTY-FIRST CENTURY FOX"],
    "MICRON TECHNOLOGY":["MICRON TECHNOLOGY"],
    "TRAVELERS":["TRAVELERS"],
    "RITE AID":["RITE AID"],
    "NORTHROP GRUMMAN":["NORTHROP GRUMMAN"],
    "ARROW ELECTRONICS":["ARROW ELECTRONICS"],
    "PHILIP MORRIS INTERNATIONAL":["PHILIP MORRIS INTERNATIONAL"],
    "NORTHWESTERN MUTUAL":["NORTHWESTERN MUTUAL"],
    "INTL FCSTONE":["INTL FCSTONE"],
    "PBF ENERGY":["PBF ENERGY"],
    "RAYTHEON":["RAYTHEON"],
    "KRAFT HEINZ":["KRAFT HEINZ"],
    "MONDELEZ INTERNATIONAL":["MONDELEZ INTERNATIONAL"],
    "U.S. BANCORP":["U.S. BANCORP"],
    "MACY'S":["MACY'S"],
    "DOLLAR GENERAL":["DOLLAR GENERAL"],
    "NUCOR":["NUCOR"],
    "STARBUCKS":["STARBUCKS"],
    "DXC TECHNOLOGY":["DXC TECHNOLOGY"],
    "ELI LILLY":["ELI LILLY"],
    "THERMO FISHER SCIENTIFIC":["THERMO FISHER SCIENTIFIC"],
    "US FOODS HOLDING":["US FOODS HOLDING"],
    "DUKE ENERGY":["DUKE ENERGY"],
    "HALLIBURTON":["HALLIBURTON"],
    "CUMMINS":["CUMMINS"],
    "AMGEN":["AMGEN"],
    "PACCAR":["PACCAR"],
    "SOUTHERN":["SOUTHERN"],
    "CENTURYLINK":["CENTURYLINK"],
    "INTERNATIONAL PAPER":["INTERNATIONAL PAPER"],
    "UNION PACIFIC":["UNION PACIFIC"],
    "DOLLAR TREE":["DOLLAR TREE"],
    "PENSKE AUTOMOTIVE GROUP":["PENSKE AUTOMOTIVE GROUP"],
    "QUALCOMM":["QUALCOMM"],
    "BRISTOL-MYERS SQUIBB":["BRISTOL-MYERS SQUIBB"],
    "GILEAD SCIENCES":["GILEAD SCIENCES"],
    "JABIL":["JABIL"],
    "MANPOWERGROUP":["MANPOWERGROUP"],
    "SOUTHWEST AIRLINES":["SOUTHWEST AIRLINES"],
    "AFLAC":["AFLAC"],
    "TESLA":["TESLA"],
    "AUTONATION":["AUTONATION"],
    "CBRE GROUP":["CBRE GROUP"],
    "LEAR":["LEAR"],
    "WHIRLPOOL":["WHIRLPOOL"],
    "MCDONALD'S":["MCDONALD'S"],
    "BROADCOM":["BROADCOM"],
    "MARRIOTT INTERNATIONAL":["MARRIOTT INTERNATIONAL"],
    "WESTERN DIGITAL":["WESTERN DIGITAL"],
    "VISA":["VISA"],
    "LENNAR":["LENNAR"],
    "WELLCARE HEALTH PLANS":["WELLCARE HEALTH PLANS"],
    "KOHL'S":["KOHL'S"],
    "AECOM":["AECOM"],
    "SYNNEX":["SYNNEX"],
    "PNC FINANCIAL SERVICES":["PNC FINANCIAL SERVICES"],
    "DANAHER":["DANAHER"],
    "HARTFORD FINANCIAL SERVICES":["HARTFORD FINANCIAL SERVICES"],
    "ALTRIA GROUP":["ALTRIA GROUP"],
    "BANK OF NEW YORK MELLON":["BANK OF NEW YORK MELLON"],
    "FLUOR":["FLUOR"],
    "AVNET":["AVNET"],
    "ICAHN ENTERPRISES":["ICAHN ENTERPRISES"],
    "OCCIDENTAL PETROLEUM":["OCCIDENTAL PETROLEUM"],
    "MOLINA HEALTHCARE":["MOLINA HEALTHCARE"],
    "GENUINE PARTS":["GENUINE PARTS"],
    "FREEPORT-MCMORAN":["FREEPORT-MCMORAN"],
    "KIMBERLY-CLARK":["KIMBERLY-CLARK"],
    "TENET HEALTHCARE":["TENET HEALTHCARE"],
    "SYNCHRONY FINANCIAL":["SYNCHRONY FINANCIAL"],
    "CARMAX":["CARMAX"],
    "HOLLYFRONTIER":["HOLLYFRONTIER"],
    "PERFORMANCE FOOD GROUP":["PERFORMANCE FOOD GROUP"],
    "SHERWIN-WILLIAMS":["SHERWIN-WILLIAMS"],
    "EMERSON ELECTRIC":["EMERSON ELECTRIC"],
    "NGL ENERGY PARTNERS":["NGL ENERGY PARTNERS"],
    "XPO LOGISTICS":["XPO LOGISTICS"],
    "EOG RESOURCES":["EOG RESOURCES"],
    "APPLIED MATERIALS":["APPLIED MATERIALS"],
    "PG&E":["PG&E"],
    "NEXTERA ENERGY":["NEXTERA ENERGY"],
    "C.H. ROBINSON WORLDWIDE":["C.H. ROBINSON WORLDWIDE"],
    "GAP":["GAP"],
    "LINCOLN NATIONAL":["LINCOLN NATIONAL"],
    "DAVITA":["DAVITA"],
    "JONES LANG LASALLE":["JONES LANG LASALLE"],
    "WESTROCK":["WESTROCK"],
    "CDW":["CDW"],
    "AMERICAN ELECTRIC POWER":["AMERICAN ELECTRIC POWER"],
    "COGNIZANT TECHNOLOGY SOLUTIONS":["COGNIZANT TECHNOLOGY SOLUTIONS"],
    "D.R. HORTON":["D.R. HORTON"],
    "BECTON DICKINSON":["BECTON DICKINSON"],
    "NORDSTROM":["NORDSTROM"],
    "NETFLIX":["NETFLIX"],
    "ARAMARK":["ARAMARK"],
    "TEXAS INSTRUMENTS":["TEXAS INSTRUMENTS"],
    "GENERAL MILLS":["GENERAL MILLS"],
    "SUPERVALU":["SUPERVALU"],
    "COLGATE-PALMOLIVE":["COLGATE-PALMOLIVE"],
    "GOODYEAR TIRE & RUBBER":["GOODYEAR TIRE & RUBBER"],
    "PAYPAL HOLDINGS":["PAYPAL HOLDINGS"],
    "PPG INDUSTRIES":["PPG INDUSTRIES"],
    "OMNICOM GROUP":["OMNICOM GROUP"],
    "CELGENE":["CELGENE"],
    "JACOBS ENGINEERING GROUP":["JACOBS ENGINEERING GROUP"],
    "ROSS STORES":["ROSS STORES"],
    "MARSH & MCLENNAN":["MARSH & MCLENNAN"],
    "MASTERCARD":["MASTERCARD"],
    "LAND O'LAKES":["LAND O'LAKES"],
    "WASTE MANAGEMENT":["WASTE MANAGEMENT"],
    "ILLINOIS TOOL WORKS":["ILLINOIS TOOL WORKS"],
    "ECOLAB":["ECOLAB"],
    "BOOKING HOLDINGS":["BOOKING HOLDINGS"],
    "CBS":["CBS"],
    "PARKER-HANNIFIN":["PARKER-HANNIFIN"],
    "PRINCIPAL FINANCIAL":["PRINCIPAL FINANCIAL"],
    "DTE ENERGY":["DTE ENERGY"],
    "BLACKROCK":["BLACKROCK"],
    "UNITED STATES STEEL":["UNITED STATES STEEL"],
    "COMMUNITY HEALTH SYSTEMS":["COMMUNITY HEALTH SYSTEMS"],
    "KINDER MORGAN":["KINDER MORGAN"],
    "QURATE RETAIL":["QURATE RETAIL"],
    "LOEWS":["LOEWS"],
    "ARCONIC":["ARCONIC"],
    "STANLEY BLACK & DECKER":["STANLEY BLACK & DECKER"],
    "TEXTRON":["TEXTRON"],
    "LAS VEGAS SANDS":["LAS VEGAS SANDS"],
    "ESTEE LAUDER":["ESTEE LAUDER"],
    "DISH NETWORK":["DISH NETWORK"],
    "STRYKER":["STRYKER"],
    "KELLOGG":["KELLOGG"],
    "BIOGEN":["BIOGEN"],
    "ALCOA":["ALCOA"],
    "ANADARKO PETROLEUM":["ANADARKO PETROLEUM"],
    "DOMINION ENERGY":["DOMINION ENERGY"],
    "ADP":["ADP"],
    "SALESFORCE.COM":["SALESFORCE.COM"],
    "L BRANDS":["L BRANDS"],
    "HENRY SCHEIN":["HENRY SCHEIN"],
    "NEWELL BRANDS":["NEWELL BRANDS"],
    "GUARDIAN LIFE INS. CO. OF AMERICA":["GUARDIAN LIFE INS. CO. OF AMERICA"],
    "BJ'S WHOLESALE CLUB":["BJ'S WHOLESALE CLUB"],
    "BB&T CORP.":["BB&T CORP."],
    "STATE STREET CORP.":["STATE STREET CORP."],
    "VIACOM":["VIACOM"],
    "AMERIPRISE FINANCIAL":["AMERIPRISE FINANCIAL"],
    "CORE-MARK HOLDING":["CORE-MARK HOLDING"],
    "REINSURANCE GROUP OF AMERICA":["REINSURANCE GROUP OF AMERICA"],
    "VF":["VF"],
    "DISCOVER FINANCIAL SERVICES":["DISCOVER FINANCIAL SERVICES"],
    "GLOBAL PARTNERS":["GLOBAL PARTNERS"],
    "EDISON INTERNATIONAL":["EDISON INTERNATIONAL"],
    "ONEOK":["ONEOK"],
    "MURPHY USA":["MURPHY USA"],
    "BED BATH & BEYOND":["BED BATH & BEYOND"],
    "CONSOLIDATED EDISON":["CONSOLIDATED EDISON"],
    "CSX":["CSX"],
    "J.C. PENNEY":["J.C. PENNEY"],
    "LKQ":["LKQ"],
    "FIRSTENERGY":["FIRSTENERGY"],
    "STEEL DYNAMICS":["STEEL DYNAMICS"],
    "LITHIA MOTORS":["LITHIA MOTORS"],
    "MGM RESORTS INTERNATIONAL":["MGM RESORTS INTERNATIONAL"],
    "TENNECO":["TENNECO"],
    "NVIDIA":["NVIDIA"],
    "SEMPRA ENERGY":["SEMPRA ENERGY"],
    "FARMERS INSURANCE EXCHANGE":["FARMERS INSURANCE EXCHANGE"],
    "BALL":["BALL"],
    "GROUP 1 AUTOMOTIVE":["GROUP 1 AUTOMOTIVE"],
    "UNUM GROUP":["UNUM GROUP"],
    "XCEL ENERGY":["XCEL ENERGY"],
    "RELIANCE STEEL & ALUMINUM":["RELIANCE STEEL & ALUMINUM"],
    "HUNTSMAN":["HUNTSMAN"],
    "NORFOLK SOUTHERN":["NORFOLK SOUTHERN"],
    "LABORATORY CORP. OF AMERICA":["LABORATORY CORP. OF AMERICA"],
    "CORNING":["CORNING"],
    "EXPEDIA GROUP":["EXPEDIA GROUP"],
    "AUTOZONE":["AUTOZONE"],
    "W.W. GRAINGER":["W.W. GRAINGER"],
    "QUANTA SERVICES":["QUANTA SERVICES"],
    "CROWN HOLDINGS":["CROWN HOLDINGS"],
    "OFFICE DEPOT":["OFFICE DEPOT"],
    "BAXTER INTERNATIONAL":["BAXTER INTERNATIONAL"],
    "LAM RESEARCH":["LAM RESEARCH"],
    "ENTERGY":["ENTERGY"],
    "CHARLES SCHWAB":["CHARLES SCHWAB"],
    "L3 TECHNOLOGIES":["L3 TECHNOLOGIES"],
    "NRG ENERGY":["NRG ENERGY"],
    "LIVE NATION ENTERTAINMENT":["LIVE NATION ENTERTAINMENT"],
    "UNIVERSAL HEALTH SERVICES":["UNIVERSAL HEALTH SERVICES"],
    "MOLSON COORS BREWING":["MOLSON COORS BREWING"],
    "EBAY":["EBAY"],
    "AES":["AES"],
    "DEVON ENERGY":["DEVON ENERGY"],
    "PACIFIC LIFE":["PACIFIC LIFE"],
    "CENTERPOINT ENERGY":["CENTERPOINT ENERGY"],
    "DISCOVERY":["DISCOVERY"],
    "BORGWARNER":["BORGWARNER"],
    "TARGA RESOURCES":["TARGA RESOURCES"],
    "ALLY FINANCIAL":["ALLY FINANCIAL"],
    "SUNTRUST BANKS":["SUNTRUST BANKS"],
    "IQVIA HOLDINGS":["IQVIA HOLDINGS"],
    "AMERICAN FAMILY INSURANCE GROUP":["AMERICAN FAMILY INSURANCE GROUP"],
    "DELEK US HOLDINGS":["DELEK US HOLDINGS"],
    "NAVISTAR INTERNATIONAL":["NAVISTAR INTERNATIONAL"],
    "CHESAPEAKE ENERGY":["CHESAPEAKE ENERGY"],
    "UNITED NATURAL FOODS":["UNITED NATURAL FOODS"],
    "LEIDOS HOLDINGS":["LEIDOS HOLDINGS"],
    "PULTEGROUP":["PULTEGROUP"],
    "EASTMAN CHEMICAL":["EASTMAN CHEMICAL"],
    "REPUBLIC SERVICES":["REPUBLIC SERVICES"],
    "MOHAWK INDUSTRIES":["MOHAWK INDUSTRIES"],
    "SONIC AUTOMOTIVE":["SONIC AUTOMOTIVE"],
    "OWENS & MINOR":["OWENS & MINOR"],
    "XEROX":["XEROX"],
    "BOSTON SCIENTIFIC":["BOSTON SCIENTIFIC"],
    "DCP MIDSTREAM":["DCP MIDSTREAM"],
    "AUTOLIV":["AUTOLIV"],
    "INTERPUBLIC GROUP":["INTERPUBLIC GROUP"],
    "PUBLIC SERVICE ENTERPRISE GROUP":["PUBLIC SERVICE ENTERPRISE GROUP"],
    "PVH":["PVH"],
    "MOSAIC":["MOSAIC"],
    "ADVANCE AUTO PARTS":["ADVANCE AUTO PARTS"],
    "ALTICE USA":["ALTICE USA"],
    "HORMEL FOODS":["HORMEL FOODS"],
    "O'REILLY AUTOMOTIVE":["O'REILLY AUTOMOTIVE"],
    "CALPINE":["CALPINE"],
    "HERTZ GLOBAL HOLDINGS":["HERTZ GLOBAL HOLDINGS"],
    "FIRST DATA":["FIRST DATA"],
    "PIONEER NATURAL RESOURCES":["PIONEER NATURAL RESOURCES"],
    "COTY":["COTY"],
    "AGCO":["AGCO"],
    "MUTUAL OF OMAHA INSURANCE":["MUTUAL OF OMAHA INSURANCE"],
    "VISTRA ENERGY":["VISTRA ENERGY"],
    "AVIS BUDGET GROUP":["AVIS BUDGET GROUP"],
    "ADOBE":["ADOBE"],
    "PETER KIEWIT SONS'":["PETER KIEWIT SONS'"],
    "NEWS CORP.":["NEWS CORP."],
    "BRIGHTHOUSE FINANCIAL":["BRIGHTHOUSE FINANCIAL"],
    "VOYA FINANCIAL":["VOYA FINANCIAL"],
    "AIR PRODUCTS & CHEMICALS":["AIR PRODUCTS & CHEMICALS"],
    "HILTON WORLDWIDE HOLDINGS":["HILTON WORLDWIDE HOLDINGS"],
    "GAMESTOP":["GAMESTOP"],
    "VERITIV":["VERITIV"],
    "WILLIAMS":["WILLIAMS"],
    "CAMPBELL SOUP":["CAMPBELL SOUP"],
    "ROCKWELL COLLINS":["ROCKWELL COLLINS"],
    "THRIVENT FINANCIAL FOR LUTHERANS":["THRIVENT FINANCIAL FOR LUTHERANS"],
    "WESTLAKE CHEMICAL":["WESTLAKE CHEMICAL"],
    "UNIVAR":["UNIVAR"],
    "J.B. HUNT TRANSPORT SERVICES":["J.B. HUNT TRANSPORT SERVICES"],
    "FRONTIER COMMUNICATIONS":["FRONTIER COMMUNICATIONS"],
    "JONES FINANCIAL (EDWARD JONES)":["JONES FINANCIAL (EDWARD JONES)"],
    "NATIONAL OILWELL VARCO":["NATIONAL OILWELL VARCO"],
    "EVERSOURCE ENERGY":["EVERSOURCE ENERGY"],
    "DICK'S SPORTING GOODS":["DICK'S SPORTING GOODS"],
    "GENWORTH FINANCIAL":["GENWORTH FINANCIAL"],
    "FIDELITY NATIONAL INFORMATION SERVICES":["FIDELITY NATIONAL INFORMATION SERVICES"],
    "YUM CHINA HOLDINGS":["YUM CHINA HOLDINGS"],
    "RYDER SYSTEM":["RYDER SYSTEM"],
    "ANIXTER INTERNATIONAL":["ANIXTER INTERNATIONAL"],
    "CAESARS ENTERTAINMENT":["CAESARS ENTERTAINMENT"],
    "MASCO":["MASCO"],
    "THOR INDUSTRIES":["THOR INDUSTRIES"],
    "ALASKA AIR GROUP":["ALASKA AIR GROUP"],
    "AMPHENOL":["AMPHENOL"],
    "WESCO INTERNATIONAL":["WESCO INTERNATIONAL"],
    "HUNTINGTON INGALLS INDUSTRIES":["HUNTINGTON INGALLS INDUSTRIES"],
    "JEFFERIES FINANCIAL GROUP":["JEFFERIES FINANCIAL GROUP"],
    "DANA":["DANA"],
    "EXPEDITORS INTL. OF WASHINGTON":["EXPEDITORS INTL. OF WASHINGTON"],
    "EMCOR GROUP":["EMCOR GROUP"],
    "DARDEN RESTAURANTS":["DARDEN RESTAURANTS"],
    "SPARTANNASH":["SPARTANNASH"],
    "ASSURANT":["ASSURANT"],
    "UNITED RENTALS":["UNITED RENTALS"],
    "LIBERTY MEDIA":["LIBERTY MEDIA"],
    "ERIE INSURANCE GROUP":["ERIE INSURANCE GROUP"],
    "AUTO-OWNERS INSURANCE":["AUTO-OWNERS INSURANCE"],
    "CHENIERE ENERGY":["CHENIERE ENERGY"],
    "FIFTH THIRD BANCORP":["FIFTH THIRD BANCORP"],
    "FOOT LOCKER":["FOOT LOCKER"],
    "CONAGRA BRANDS":["CONAGRA BRANDS"],
    "ZIMMER BIOMET HOLDINGS":["ZIMMER BIOMET HOLDINGS"],
    "TRACTOR SUPPLY":["TRACTOR SUPPLY"],
    "BERRY GLOBAL GROUP":["BERRY GLOBAL GROUP"],
    "ALLIANCE DATA SYSTEMS":["ALLIANCE DATA SYSTEMS"],
    "HERSHEY":["HERSHEY"],
    "PPL":["PPL"],
    "DEAN FOODS":["DEAN FOODS"],
    "BUILDERS FIRSTSOURCE":["BUILDERS FIRSTSOURCE"],
    "OSHKOSH":["OSHKOSH"],
    "ENLINK MIDSTREAM":["ENLINK MIDSTREAM"],
    "W.R. BERKLEY":["W.R. BERKLEY"],
    "WEC ENERGY GROUP":["WEC ENERGY GROUP"],
    "JETBLUE AIRWAYS":["JETBLUE AIRWAYS"],
    "UGI":["UGI"],
    "A-MARK PRECIOUS METALS":["A-MARK PRECIOUS METALS"],
    "FIDELITY NATIONAL FINANCIAL":["FIDELITY NATIONAL FINANCIAL"],
    "CONSTELLATION BRANDS":["CONSTELLATION BRANDS"],
    "QUEST DIAGNOSTICS":["QUEST DIAGNOSTICS"],
    "ACTIVISION BLIZZARD":["ACTIVISION BLIZZARD"],
    "WEYERHAEUSER":["WEYERHAEUSER"],
    "RAYMOND JAMES FINANCIAL":["RAYMOND JAMES FINANCIAL"],
    "CASEY'S GENERAL STORES":["CASEY'S GENERAL STORES"],
    "KEURIG DR PEPPER":["KEURIG DR PEPPER"],
    "AMERICAN TOWER":["AMERICAN TOWER"],
    "APACHE":["APACHE"],
    "DOVER":["DOVER"],
    "KEYCORP":["KEYCORP"],
    "J.M. SMUCKER":["J.M. SMUCKER"],
    "CITIZENS FINANCIAL GROUP":["CITIZENS FINANCIAL GROUP"],
    "MOTOROLA SOLUTIONS":["MOTOROLA SOLUTIONS"],
    "MAGELLAN HEALTH":["MAGELLAN HEALTH"],
    "AMERICAN AXLE & MANUFACTURING":["AMERICAN AXLE & MANUFACTURING"],
    "NEWMONT GOLDCORP":["NEWMONT GOLDCORP"],
    "SPIRIT AEROSYSTEMS HOLDINGS":["SPIRIT AEROSYSTEMS HOLDINGS"],
    "WESTERN & SOUTHERN FINANCIAL GROUP":["WESTERN & SOUTHERN FINANCIAL GROUP"],
    "FORTIVE":["FORTIVE"],
    "GRAYBAR ELECTRIC":["GRAYBAR ELECTRIC"],
    "NVR":["NVR"],
    "AVERY DENNISON":["AVERY DENNISON"],
    "CELANESE":["CELANESE"],
    "AMERICAN FINANCIAL GROUP":["AMERICAN FINANCIAL GROUP"],
    "TOLL BROTHERS":["TOLL BROTHERS"],
    "SANMINA":["SANMINA"],
    "INSIGHT ENTERPRISES":["INSIGHT ENTERPRISES"],
    "OWENS CORNING":["OWENS CORNING"],
    "PACKAGING CORP. OF AMERICA":["PACKAGING CORP. OF AMERICA"],
    "TRAVELCENTERS OF AMERICA":["TRAVELCENTERS OF AMERICA"],
    "OLIN":["OLIN"],
    "ARTHUR J. GALLAGHER":["ARTHUR J. GALLAGHER"],
    "MASTEC":["MASTEC"],
    "ALLEGHANY":["ALLEGHANY"],
    "OWENS-ILLINOIS":["OWENS-ILLINOIS"],
    "ASBURY AUTOMOTIVE GROUP":["ASBURY AUTOMOTIVE GROUP"],
    "CMS ENERGY":["CMS ENERGY"],
    "MARKEL":["MARKEL"],
    "BLACKSTONE GROUP":["BLACKSTONE GROUP"],
    "AK STEEL HOLDING":["AK STEEL HOLDING"],
    "HANESBRANDS":["HANESBRANDS"],
    "R.R. DONNELLEY & SONS":["R.R. DONNELLEY & SONS"],
    "WAYFAIR":["WAYFAIR"],
    "REGIONS FINANCIAL":["REGIONS FINANCIAL"],
    "WYNN RESORTS":["WYNN RESORTS"],
    "ULTA BEAUTY":["ULTA BEAUTY"],
    "REGENERON PHARMACEUTICALS":["REGENERON PHARMACEUTICALS"],
    "BURLINGTON STORES":["BURLINGTON STORES"],
    "ROCKWELL AUTOMATION":["ROCKWELL AUTOMATION"],
    "NORTHERN TRUST":["NORTHERN TRUST"],
    "CHEMOURS":["CHEMOURS"],
    "SEABOARD":["SEABOARD"],
    "MARATHON OIL":["MARATHON OIL"],
    "ASCENA RETAIL GROUP":["ASCENA RETAIL GROUP"],
    "DILLARD'S":["DILLARD'S"],
    "CINTAS":["CINTAS"],
    "ADVANCED MICRO DEVICES":["ADVANCED MICRO DEVICES"],
    "HESS":["HESS"],
    "M&T BANK CORP.":["M&T BANK CORP."],
    "ABM INDUSTRIES":["ABM INDUSTRIES"],
    "BEACON ROOFING SUPPLY":["BEACON ROOFING SUPPLY"],
    "NCR":["NCR"],
    "IHEARTMEDIA":["IHEARTMEDIA"],
    "FRANKLIN RESOURCES":["FRANKLIN RESOURCES"],
    "AMEREN":["AMEREN"],
    "INTERCONTINENTAL EXCHANGE":["INTERCONTINENTAL EXCHANGE"],
    "S&P GLOBAL":["S&P GLOBAL"],
    "POST HOLDINGS":["POST HOLDINGS"],
    "ANALOG DEVICES":["ANALOG DEVICES"],
    "RALPH LAUREN":["RALPH LAUREN"],
    "L3HARRIS TECHNOLOGIES":["L3HARRIS TECHNOLOGIES"],
    "BOOZ ALLEN HAMILTON":["BOOZ ALLEN HAMILTON"],
    "POLARIS INDUSTRIES":["POLARIS INDUSTRIES"],
    "CLOROX":["CLOROX"],
    "REALOGY HOLDINGS":["REALOGY HOLDINGS"],
    "HD SUPPLY HOLDINGS":["HD SUPPLY HOLDINGS"],
    "GRAPHIC PACKAGING HOLDING":["GRAPHIC PACKAGING HOLDING"],
    "OLD REPUBLIC INTERNATIONAL":["OLD REPUBLIC INTERNATIONAL"],
    "INTUIT":["INTUIT"],
    "NETAPP":["NETAPP"],
    "TAPESTRY":["TAPESTRY"],
    "ON SEMICONDUCTOR":["ON SEMICONDUCTOR"],
    "INGREDION":["INGREDION"],
    "ZOETIS":["ZOETIS"],
    "FISERV":["FISERV"],
    "TREEHOUSE FOODS":["TREEHOUSE FOODS"],
    "ROBERT HALF INTERNATIONAL":["ROBERT HALF INTERNATIONAL"],
    "FIRST AMERICAN FINANCIAL":["FIRST AMERICAN FINANCIAL"],
    "HARLEY-DAVIDSON":["HARLEY-DAVIDSON"],
    "WINDSTREAM HOLDINGS":["WINDSTREAM HOLDINGS"],
    "YUM BRANDS":["YUM BRANDS"],
    "WILLIAMS-SONOMA":["WILLIAMS-SONOMA"],
    "SIMON PROPERTY GROUP":["SIMON PROPERTY GROUP"],
    "NAVIENT":["NAVIENT"],
    "WESTERN UNION":["WESTERN UNION"],
    "PEABODY ENERGY":["PEABODY ENERGY"],
    "LEVI STRAUSS":["LEVI STRAUSS"]
}

fortune_lob_ids = set()
lob_id_to_company = {}

# Step 1: Load data from the LobbyView datasets 
clients = pd.read_csv("../data/LobbyView/lobbyview_clients.csv")
reports = pd.read_csv("../data/LobbyView/lobbyview_reports.csv")
issues  = pd.read_csv("../data/LobbyView/lobbyview_issue_text.csv")
bills   = pd.read_csv("../data/LobbyView/lobbyview_bills.csv")

CLIENT_NAME_COL = "client_name"

# We need to expand the bill_id_agg column into individual bill_ids
issues_long = issues.copy()
issues_long["bill_id_agg"] = (
    issues_long["bill_id_agg"]
      .fillna("")                                   # handle NaNs
      .astype(str)
      .str.replace(r'[{}\"]', '', regex=True)
      .str.replace(r'^\s*nan\s*$', '', regex=True)  # guard against string "nan"
)

# Explode the bill_id_agg column into individual bill_ids
issues_long = issues_long.assign(
    bill_id=issues_long["bill_id_agg"].str.split(",")
).explode("bill_id")
issues_long["bill_id"] = issues_long["bill_id"].str.strip()
issues_long = issues_long[issues_long["bill_id"] != ""]

# Step 2: Join the issues_long dataframe to the bills dataframe and filter to the 116th Congress
issue_bills = issues_long.merge(
    bills[["bill_id", "congress_number", "bioguide_id"]],
    on="bill_id",
    how="left"
)
issue_bills_116 = issue_bills[issue_bills["congress_number"] == 116].copy()

# Step 3: Join in the lobbying reports
ib_reports = issue_bills_116.merge(
    reports[["report_uuid", "lob_id", "amount"]],
    on="report_uuid",
    how="left"
)

# Step 4: Join in the client information for the bills we filtered to
ib_clients = ib_reports.merge(
    clients[["lob_id", CLIENT_NAME_COL]],
    on="lob_id",
    how="left"
)

# Use exact matching to get just the clients we are itnerested in
def normalize_name(name):
    if not isinstance(name, str):
        return None 
    name_upper = name.upper().strip()
    
    for key, variations in fortune_500_names.items():
        if name_upper == key:              # allow matching canonical names
            return key
        for variation in variations:
            if name_upper == variation:
                return key
    return None

unique_clients = ib_clients[["lob_id", "client_name"]].drop_duplicates()

# Map each unique client to its normalized fortune 500 name from our list and store lob_ids
for _, row in unique_clients.iterrows():
    client_name = row["client_name"]
    lob_id = row["lob_id"]
    client_name_norm = normalize_name(client_name)
    if client_name_norm:
        fortune_lob_ids.add(lob_id)
        lob_id_to_company[lob_id] = client_name_norm

# Step 5: Map each lob_id to its normalized fortune 500 company name
ib_clients["fortune_client_name"] = ib_clients["lob_id"].map(lob_id_to_company)
filtered = ib_clients[ib_clients["fortune_client_name"].notna()].copy()
filtered["client_name"] = filtered["fortune_client_name"]

# Here is the final output for the cleaned csv file of Fortune 500 LDA reports for the 116th Congress
final = (
    filtered[["client_name", "lob_id", "report_uuid", "bill_id", "amount"]]
    .drop_duplicates()
)

final.to_csv("../data/fortune500_lda_reports.csv", index=False)

# Print stats
print(f"Total records: {len(final)}")
print(f"Unique clients: {final['client_name'].nunique()}")
print(f"Unique bills: {final['bill_id'].nunique()}")